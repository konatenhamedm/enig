{% extends '_admin/_includes/index.html.twig' %}

{% block titre %}EDITION{% endblock %}
{% from '_admin/macros/fichier.html.twig' import image %}
{% block page_content %}
    {% set new = menu.getRoute %}
    <div class="page-header">
        <h1 class="page-title">{{ new |capitalize }}</h1>
        <div>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="javascript:void(0)">Gestion des clients</a></li>
                <li class="breadcrumb-item active" aria-current="page">{{ new | capitalize }}</li>
            </ol>
        </div>

    </div>

    <div class="card">
        <div class="card-header">
            <h3 class="card-title">DETAILS-CLIENT</h3>
        </div>
        <div class="card-body">
            {% form_theme form 'bootstrap_5_layout.html.twig' %}
            {{ form_start(form, {'attr': {'role':'form', 'class': 'form'}}) }}
            <div class="modal-body">
                {# {{ include('includes/ajax/response.html.twig') }} #}
                <div class="row">
                    <div class="form-group col-md-1">

                        {{ form_widget(form.existe,{'attr':{'class':'border-primary checkbox','type':'checkbox','id':'userinput1'}}) }}
                        {{ form_widget(form.etat,{'attr':{'class':'form-control border-primary','type':'hidden','id':'userinput1'}}) }}
                    </div>
                    {# <div class="col-md-6 " style="margin-left: -55px;margin-top: -1px">

                         <span style="font-weight: bolder">Numéro Automatique</span>
                     </div>#}

                </div>
                <div class="row" id="principal" style="margin-top: -12px">
                    <div class="form-group col-md-8 " id="p2">

                        <h3 class="mot">Cochez cette option pour une numérotation automatique</h3>
                        {# <h3 class="mot1">Décochez cette option pour une numérotation personnalisée</h3>#}
                    </div>

                </div>
                <div class="contenu" style="margin-top: -10px">
                    <div class="row">
                        <div class="form-group col-md-6 ">
                            <label class="sr-onl" for="userinput1">Date de réception</label>
                            {{ form_widget(form.dateReception,{'attr':{'class':'form-control border-primary','id':'userinput1','placeholder':'NOM','required':'required'}}) }}
                            {# <input type="text" id="userinput1" class="form-control border-primary" placeholder="Compte contribuable" name="name">#}
                        </div>
                        <div class="form-group col-md-6">
                            <label class="sr-onl" for="userinput1">N d'enregistrement</label>
                            {{ form_widget(form.numero,{'attr':{'class':'form-control border-primary','id':'userinput1','placeholder':'Numero'}}) }}
                            {# <input type="text" id="userinput1" class="form-control border-primary" placeholder="Compte contribuable" name="name">#}
                        </div>


                    </div>
                    <div class="row">
                        <div class="form-group col-md-12 ">
                            <label class="sr-onl" for="userinput1">Rangement</label>
                            {{ form_widget(form.rangement,{'attr':{'class':'form-control border-primary','id':'userinput1','placeholder':'rangement'}}) }}
                            {# <input type="text" id="userinput1" class="form-control border-primary" placeholder="Compte contribuable" name="name">#}
                        </div>

                    </div>
                    <div class="row">
                        <div class="form-group col-md-12 ">
                            <label class="sr-onl" for="userinput1">Objet</label>
                            {{ form_widget(form.objet,{'attr':{'class':'form-control border-primary','id':'userinput1','placeholder':'Objet','required':'required'}}) }}
                            {# <input type="text" id="userinput1" class="form-control border-primary" placeholder="Compte contribuable" name="name">#}
                        </div>
                    </div>

                    <div class="arrive">
                        <div class="row">
                            <div class="form-group col-md-6 ">
                                <label class="sr-onl" for="userinput1">Réceptionné par</label>
                                {{ form_widget(form.user,{'attr':{'class':'form-control border-primary','id':'userinput1','placeholder':'Réceptionné par'}}) }}
                                {# <input type="text" id="userinput1" class="form-control border-primary" placeholder="Compte contribuable" name="name">#}
                            </div>
                            <div class="form-group col-md-6 ">
                                <label class="sr-onl" for="userinput1">Expéditeur</label>
                                {{ form_widget(form.expediteur,{'attr':{'class':'form-control border-primary','id':'userinput1','placeholder':'Expéditeur'}}) }}
                                {# <input type="text" id="userinput1" class="form-control border-primary" placeholder="Compte contribuable" name="name">#}
                            </div>
                        </div>
                    </div>
                    <div class="autre">
                        <div class="row">
                            <div class="form-group col-md-6 ">
                                <label class="sr-onl" for="userinput1">Réceptionné par</label>
                                {{ form_widget(form.recep,{'attr':{'class':'form-control border-primary','id':'userinput1','placeholder':'Réceptionné par'}}) }}
                                {# <input type="text" id="userinput1" class="form-control border-primary" placeholder="Compte contribuable" name="name">#}
                            </div>
                            <div class="form-group col-md-6 ">
                                <label class="sr-onl" for="userinput1">Expéditeur</label>
                                {{ form_widget(form.exp,{'attr':{'class':'form-control border-primary','id':'userinput1','placeholder':'Expéditeur'}}) }}
                                {# <input type="text" id="userinput1" class="form-control border-primary" placeholder="Compte contribuable" name="name">#}
                            </div>
                        </div>

                    </div>
                </div>
                <span class="col-lg-12 groupe" id="groupe" data-prototype="{{ image(form.fichiers.vars.prototype)|e('html_attr') }}">

            {#   <div class="row" >#}

                    {#   <div class="col-md-1">#}
                    {#  <button type="button" class="waves-effect waves-light btn btn-primary  add_intervention" >
                          <i class="fa fa-plus-circle"></i></button>#}

                    {#   </div>#}

                    {# </div>
                     <br>#}
            <div class="col-md-12">
                <a href="#" class="btn btn-secondary add_groupe" style="margin-left: -20px" data-card-tool="remove"
                   data-toggle="tooltip" data-placement="top" title="" data-original-title="Remove Card">Ajouter un
                    fichier </a>
            </div>
                    <br>
            {% for fichier in data %}
                <div class="row">
                   {# <div class="col-sm-3">
                       <img class="avatar avatar-4by3" height="10px" src="{{ asset('assets/svg/brands/pdf.svg') }}" alt="Image Description">
                    </div>#}
                    <span class="col-sm-5">
                        <h3 style="font-weight: bolder">{{ fichier.titre }}</h3>
                    </span>
                    <span class="col-sm-3">

                <a href="{{ asset('uploads/images/' ~ fichier.path) }}" download> <i class="tio-download"></i>Télecharger</a>
                    </span>
                </div>
                {#<img class="avatar avatar-4by3" height="10px" src="{{ asset('assets/svg/brands/pdf.svg') }}" alt="Image Description">#}

            {% endfor %}
            <br>
            {% for row in form.fichiers %}
                <span class="container col-md-12 existe">
                    {{ image(row|e) }}

                </span>
            {% endfor %}
 <input class="after" type="hidden"/>
        </span>


            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                <button class="btn btn-primary">Valider</button>
            </div>
            {{ form_end(form) }}
    </div>



{% endblock %}
   {% block javascripts %}
       <script src="{{ asset('admin/admin/js/jquery3.1.js') }}"></script>
       <script>

           $(function() {
               $('#client_nom').keyup(function() {
                   this.value = this.value.toLocaleUpperCase();
               });
           });

           function enMajuscule(str)
           {
               return str.split(/\s+/).map(s => s.charAt(0).toUpperCase() + s.substring(1).toLowerCase()).join(" ");
           }

           $('#client_prenom').on('keyup', function(event) {
               var $prenom = $(this);
               $prenom.val(enMajuscule($prenom.val()));
           });

           $(document).ready(function () {
               $('.bt').on('click',function () {
                   $.ajax({
                       url: '/client/new',
                       type: 'get',
                       dataType: 'json',
                       success: function (response, status) {

                           console.log(response);
                       },
                       error: function (error) {
                           console.log(error);
                       }
                   });
               })
               const value = $('#clien_situation').val();
               const precedent = $('#client_precedentMariage').val();
               console.log(precedent)
               if (precedent === "NON"){

                   $('.precedent-mariage-oblige').hide();
                   /* $('.deces').hide();
                    $('.divorce').hide();*/
                   $('#client_etat').hide();
               }
               if (precedent === "OUI"){
                   $('.precedent-mariage-oblige').show();
                   $('.etat').show();


                   /*$('.datePrecedent').show();
                   $('.regime').show();*/
               }
               if (value !== "CELIBATAIRE"){
                   //  $('.precedent-mariage').hide()

                   if (value === "VEUF"){
                       $('.deces').show();

                   }else{
                       $('.deces').hide();
                   }

                   if (value === "DIVORCE"){
                       $('.divorce').show();

                   }else{
                       $('.divorce').hide();
                   }

                   $('.situation').show();
               }else{
                   $("#client_precedentMariage").show()
                   $('.situation').hide();
               }

               $('.situation').hide();

               $("#client_precedentMariage").on('change',function (e) {
                   var precedent = $(this).val();
                   console.log(precedent)
                   if (precedent === "NON"){

                       $('.precedent-mariage-oblige').hide();
                       $('.deces').hide();
                       $('.divorce').hide();
                       $('.etat').hide();
                   }else {
                       $('.precedent-mariage-oblige').show();
                       $('.etat').show();

                       $('.divorce').show();
                       /*$('.datePrecedent').show();
                       $('.regime').show();*/
                   }
               })
               $('.existe').remove();
               $("#client_etat").on('change',function (e) {
                   var precedent = $(this).val();
                   console.log(precedent)
                   if (precedent === "DIVORCE"){


                       $('.deces').hide();
                       $('.divorce').show();

                   }else {

                       $('.deces').show();
                       $('.divorce').hide();

                       /*$('.datePrecedent').show();
                       $('.regime').show();*/
                   }
               })


               $("#client_contratMariageConjoint").on('change',function (e) {
                   var precedent = $(this).val();
                   console.log(precedent)
                   if (precedent === "NON"){

                       $('.affirmatif').hide();

                   }else {
                       $('.affirmatif').show();

                   }
               })
               $('#client_situation').on('change',function (e) {
                   var value = $(this).val();
                   console.log(value)


                   if (value !== "CELIBATAIRE"){
                       //  $('.precedent-mariage').hide()

                       if (value === "VEUF"){
                           $('.deces').show();

                       }else{
                           $('.deces').hide();
                       }

                       if (value === "DIVORCE"){
                           $('.divorce').show();

                       }else{
                           $('.divorce').hide();
                       }

                       $('.situation').show();
                   }else{
                       $("#client_precedentMariage").show()
                       $('.situation').hide();
                   }
               });

           })
           // $('select').select2();
       </script>
   {% endblock %}
